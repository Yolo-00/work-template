import{w as D}from"./index-C1ILFQut.js";import{e as V,a5 as e,f as U,h as P,i as t,w as d,ao as O,r,ap as R,j as v,Q as $,u as h,aq as q,v as I,ar as L,t as C,D as S,U as Q,S as k,as as T}from"./vendor-tduSOmKd.js";const G=V({__name:"index",props:{height:{default:"80vh"},customOptions:{}},setup(x,{expose:f}){const i=x,l=e(!1),a=e(!0),p=e(),o=e("http://static.shanhuxueyuan.com/test.docx"),s=U(()=>({height:i.height})),u=()=>{a.value=!1};return f({open:async c=>{l.value=!0,c&&(o.value=c),fetch(o.value).then(n=>n.blob()).then(n=>{n.type=="application/vnd.openxmlformats-officedocument.wordprocessingml.document"?p.value=n:O({title:"提示",message:"目前仅支持预览 Docx 类型的文件",type:"warning"})})}}),(c,n)=>{const w=r("el-dialog"),y=R("loading");return v(),P("div",null,[t(w,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=_=>l.value=_),"align-center":"",title:"预览",width:"80%"},{default:d(()=>[$(t(h(q),{options:c.customOptions,style:I(s.value),src:p.value,onRendered:u},null,8,["options","style","src"]),[[y,a.value]])]),_:1},8,["modelValue"])])}}}),H=D(G),J=H,K=V({__name:"index",props:{height:{default:"80vh"},customOptions:{}},setup(x,{expose:f}){const i=x,l=e(!1),a=e(!0),p=e(),o=e("http://static.shanhuxueyuan.com/demo/excel.xlsx"),s=U(()=>({height:i.height})),u=()=>{a.value=!1};return f({open:async c=>{l.value=!0,c&&(o.value=c),fetch(o.value).then(n=>n.blob()).then(n=>{n.type=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?p.value=n:O({title:"提示",message:"目前仅支持预览 Excel 类型的文件",type:"warning"})})}}),(c,n)=>{const w=r("el-dialog"),y=R("loading");return v(),P("div",null,[t(w,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=_=>l.value=_),"align-center":"",title:"预览",width:"80%"},{default:d(()=>[$(t(h(L),{options:c.customOptions,style:I(s.value),src:p.value,onRendered:u},null,8,["options","style","src"]),[[y,a.value]])]),_:1},8,["modelValue"])])}}}),M=D(K),W=M,X={flex:"~ justify-between items-center"},Y={key:1},Z={flex:"~ items-center"},ee="https://raw.githubusercontent.com/mozilla/pdf.js/ba2edeae/web/compressed.tracemonkey-pldi-09.pdf",te=V({__name:"index",setup(x,{expose:f}){const i=e(!1),l=e(!1),a=e(),p=e(""),o=e(1),s=e(1),u=e(!1),m=(_=ee)=>{p.value=_,i.value=!0,l.value=!0},c=()=>{l.value=!1,s.value=a.value.doc.numPages},n=()=>{o.value=u.value?void 0:1},w=()=>{a.value.download()},y=()=>{a.value.print()};return f({open:m}),(_,g)=>{const B=r("el-pagination"),N=r("el-checkbox"),j=r("SvgIcon"),E=r("el-tooltip"),z=r("el-scrollbar"),A=r("el-dialog"),F=R("loading");return v(),P("div",null,[t(A,{modelValue:i.value,"onUpdate:modelValue":g[2]||(g[2]=b=>i.value=b),title:"预览",width:"80%","align-center":"","destroy-on-close":""},{default:d(()=>[C("div",X,[C("div",null,[u.value?(v(),P("div",Y,"共"+Q(s.value)+"页",1)):(v(),S(B,{key:0,"current-page":o.value,"onUpdate:currentPage":g[0]||(g[0]=b=>o.value=b),layout:"prev, pager, next","page-size":1,total:s.value,"hide-on-single-page":""},null,8,["current-page","total"]))]),C("div",Z,[t(N,{modelValue:u.value,"onUpdate:modelValue":g[1]||(g[1]=b=>u.value=b),onChange:n},{default:d(()=>[k("展示所有")]),_:1},8,["modelValue"]),t(E,{effect:"dark",content:"下载"},{default:d(()=>[t(j,{"ml-2":"","cursor-pointer":"",onClick:w,"icon-style":{width:"20px",height:"20px"},name:"download"})]),_:1}),t(E,{effect:"dark",content:"打印"},{default:d(()=>[t(j,{"ml-2":"","cursor-pointer":"",onClick:y,"icon-style":{width:"20px",height:"20px"},name:"printing"})]),_:1})])]),$((v(),S(z,{"mt-3":"",height:"75vh"},{default:d(()=>[t(h(T),{ref_key:"pdfRef",ref:a,container:"","overflow-auto":"",source:p.value,page:o.value,onRendered:c},null,8,["source","page"])]),_:1})),[[F,l.value]])]),_:1},8,["modelValue"])])}}}),oe=D(te),ne=oe,se=V({__name:"index",setup(x){const f=e(),i=e(),l=e(),a=["https://fuss10.elemecdn.com/a/3f/3302e58f9a181d2509f3dc0fa68b0jpeg.jpeg","https://fuss10.elemecdn.com/d/e6/c4d93a3805b3ce3f323f7974e6f78jpeg.jpeg","https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg"];return(p,o)=>{const s=r("el-button"),u=r("ImagePreview");return v(),P("div",null,[t(h(J),{ref_key:"docxPreviewRef",ref:f},null,512),t(h(W),{ref_key:"excelPreviewRef",ref:i},null,512),t(h(ne),{ref_key:"pdfPreviewRef",ref:l},null,512),t(s,{type:"primary",onClick:o[0]||(o[0]=m=>f.value.open())},{default:d(()=>[k("Docx文件预览")]),_:1}),t(s,{type:"primary",onClick:o[1]||(o[1]=m=>i.value.open())},{default:d(()=>[k("Excel文件预览")]),_:1}),t(s,{type:"primary",onClick:o[2]||(o[2]=m=>l.value.open())},{default:d(()=>[k("pdf文件预览")]),_:1}),t(u,{class:"mt-5","image-url":a})])}}});export{se as default};
