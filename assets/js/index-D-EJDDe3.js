import{w as D}from"./index-DrdBoU9J.js";import{e as V,a3 as t,f as U,h as P,i as o,w as d,am as O,r,an as R,j as m,Q as $,u as x,ao as q,v as I,ap as L,t as C,D as S,U as Q,S as k,aq as T}from"./vendor-BVCdggem.js";const G=V({__name:"index",props:{height:{default:"80vh"},customOptions:{}},setup(h,{expose:f}){const c=h,l=t(!1),a=t(!0),p=t(),e=t("http://static.shanhuxueyuan.com/test.docx"),s=U(()=>({height:c.height})),u=()=>{a.value=!1};return f({open:async i=>{l.value=!0,i&&(e.value=i),fetch(e.value).then(n=>n.blob()).then(n=>{n.type=="application/vnd.openxmlformats-officedocument.wordprocessingml.document"?p.value=n:O({title:"提示",message:"目前仅支持预览 Docx 类型的文件",type:"warning"})})}}),(i,n)=>{const w=r("el-dialog"),y=R("loading");return m(),P("div",null,[o(w,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=_=>l.value=_),"align-center":"",title:"预览",width:"80%"},{default:d(()=>[$(o(x(q),{options:i.customOptions,style:I(s.value),src:p.value,onRendered:u},null,8,["options","style","src"]),[[y,a.value]])]),_:1},8,["modelValue"])])}}}),H=D(G),J=H,K=V({__name:"index",props:{height:{default:"80vh"},customOptions:{}},setup(h,{expose:f}){const c=h,l=t(!1),a=t(!0),p=t(),e=t("http://static.shanhuxueyuan.com/demo/excel.xlsx"),s=U(()=>({height:c.height})),u=()=>{a.value=!1};return f({open:async i=>{l.value=!0,i&&(e.value=i),fetch(e.value).then(n=>n.blob()).then(n=>{n.type=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?p.value=n:O({title:"提示",message:"目前仅支持预览 Excel 类型的文件",type:"warning"})})}}),(i,n)=>{const w=r("el-dialog"),y=R("loading");return m(),P("div",null,[o(w,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=_=>l.value=_),"align-center":"",title:"预览",width:"80%"},{default:d(()=>[$(o(x(L),{options:i.customOptions,style:I(s.value),src:p.value,onRendered:u},null,8,["options","style","src"]),[[y,a.value]])]),_:1},8,["modelValue"])])}}}),M=D(K),W=M,X={flex:"~ justify-between items-center"},Y={key:1},Z={flex:"~ items-center"},ee="https://raw.githubusercontent.com/mozilla/pdf.js/ba2edeae/web/compressed.tracemonkey-pldi-09.pdf",te=V({__name:"index",setup(h,{expose:f}){const c=t(!1),l=t(!1),a=t(),p=t(""),e=t(1),s=t(1),u=t(!1),g=(_=ee)=>{p.value=_,c.value=!0,l.value=!0},i=()=>{l.value=!1,s.value=a.value.doc.numPages},n=()=>{e.value=u.value?void 0:1},w=()=>{a.value.download()},y=()=>{a.value.print()};return f({open:g}),(_,v)=>{const B=r("el-pagination"),N=r("el-checkbox"),j=r("SvgIcon"),E=r("el-tooltip"),z=r("el-scrollbar"),A=r("el-dialog"),F=R("loading");return m(),P("div",null,[o(A,{modelValue:c.value,"onUpdate:modelValue":v[2]||(v[2]=b=>c.value=b),title:"预览",width:"80%","align-center":"","destroy-on-close":""},{default:d(()=>[C("div",X,[C("div",null,[u.value?(m(),P("div",Y,"共"+Q(s.value)+"页",1)):(m(),S(B,{key:0,"current-page":e.value,"onUpdate:currentPage":v[0]||(v[0]=b=>e.value=b),layout:"prev, pager, next","page-size":1,total:s.value,"hide-on-single-page":""},null,8,["current-page","total"]))]),C("div",Z,[o(N,{modelValue:u.value,"onUpdate:modelValue":v[1]||(v[1]=b=>u.value=b),onChange:n},{default:d(()=>v[3]||(v[3]=[k("展示所有")])),_:1},8,["modelValue"]),o(E,{effect:"dark",content:"下载"},{default:d(()=>[o(j,{"ml-2":"","cursor-pointer":"",onClick:w,"icon-style":{width:"20px",height:"20px"},name:"download"})]),_:1}),o(E,{effect:"dark",content:"打印"},{default:d(()=>[o(j,{"ml-2":"","cursor-pointer":"",onClick:y,"icon-style":{width:"20px",height:"20px"},name:"printing"})]),_:1})])]),$((m(),S(z,{"mt-3":"",height:"75vh"},{default:d(()=>[o(x(T),{ref_key:"pdfRef",ref:a,container:"","overflow-auto":"",source:p.value,page:e.value,onRendered:i},null,8,["source","page"])]),_:1})),[[F,l.value]])]),_:1},8,["modelValue"])])}}}),oe=D(te),ne=oe,se=V({__name:"index",setup(h){const f=t(),c=t(),l=t(),a=["https://fuss10.elemecdn.com/a/3f/3302e58f9a181d2509f3dc0fa68b0jpeg.jpeg","https://fuss10.elemecdn.com/d/e6/c4d93a3805b3ce3f323f7974e6f78jpeg.jpeg","https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg"];return(p,e)=>{const s=r("el-button"),u=r("ImagePreview");return m(),P("div",null,[o(x(J),{ref_key:"docxPreviewRef",ref:f},null,512),o(x(W),{ref_key:"excelPreviewRef",ref:c},null,512),o(x(ne),{ref_key:"pdfPreviewRef",ref:l},null,512),o(s,{type:"primary",onClick:e[0]||(e[0]=g=>f.value.open())},{default:d(()=>e[3]||(e[3]=[k("Docx文件预览")])),_:1}),o(s,{type:"primary",onClick:e[1]||(e[1]=g=>c.value.open())},{default:d(()=>e[4]||(e[4]=[k("Excel文件预览")])),_:1}),o(s,{type:"primary",onClick:e[2]||(e[2]=g=>l.value.open())},{default:d(()=>e[5]||(e[5]=[k("pdf文件预览")])),_:1}),o(u,{class:"mt-5","image-url":a})])}}});export{se as default};
